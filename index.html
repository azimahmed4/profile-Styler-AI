<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Magic AI - Pro Version</title>
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css">
    <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
    <style>
        /* Advanced Multiple Radial Background */
        body { 
            font-family: 'Inter', sans-serif; 
            margin: 0;
            background: 
                radial-gradient(circle at 20% 30%, #2e1065 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, #0c4a6e 0%, transparent 40%),
                radial-gradient(circle at 50% 50%, #0f172a 0%, #020617 100%);
            color: white; 
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container { 
            background: rgba(15, 23, 42, 0.6); 
            padding: 40px; 
            border-radius: 30px; 
            box-shadow: 0 0 50px rgba(0,0,0,0.8); 
            border: 1px solid rgba(255,255,255,0.05);
            backdrop-filter: blur(15px);
            margin-top: 50px;
            text-align: center;
        }

        /* Stylish Upload Button */
        .custom-file-upload {
            border: 2px dashed #38bdf8;
            display: inline-block;
            padding: 15px 30px;
            cursor: pointer;
            border-radius: 15px;
            background: rgba(56, 189, 248, 0.05);
            transition: 0.3s;
            margin-bottom: 20px;
        }
        .custom-file-upload:hover { background: rgba(56, 189, 248, 0.15); }
        input[type="file"] { display: none; }

        .btn-group { margin-top: 25px; display: flex; gap: 15px; justify-content: center; }
        
        .btn { border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .magic-btn { background: linear-gradient(135deg, #3b82f6, #8b5cf6); color: white; }
        .dl-btn { background: #10b981; color: white; display: none; text-decoration: none; }

        #output { 
            margin-top: 30px; 
            border-radius: 50%; 
            width: 350px; 
            height: 350px; 
            object-fit: cover; 
            display: none;
            box-shadow: 0 0 40px rgba(139, 92, 246, 0.3);
        }

        #status { margin-top: 20px; color: #38bdf8; font-size: 14px; }

        /* Developer Footer */
        footer { margin-top: auto; padding: 30px; text-align: center; }
        .dev-link { 
            color: #38bdf8; 
            text-decoration: none; 
            font-weight: bold; 
            font-size: 16px;
            border-bottom: 1px solid transparent;
            transition: 0.3s;
        }
        .dev-link:hover { border-bottom: 1px solid #38bdf8; color: #7dd3fc; }
    </style>
</head>
<body>

    <div class="container">
        <h1><span style="color: #38bdf8;">Profile</span> Magic Pro</h1>
        <p style="color: #94a3b8;">Style your profile with AI & Radial Effects</p>
        
        <label class="custom-file-upload">
            <input type="file" id="file-upload" accept="image/*"/>
            üìÅ Choose a Photo
        </label>
        
        <div class="btn-group">
            <button id="magic-btn" class="btn magic-btn" py-click="apply_ai_style">Generate Magic ‚ú®</button>
            <a id="download-link" class="btn dl-btn">Download üì•</a>
        </div>
        
        <div id="status">Ready to style...</div>
        <img id="output">
    </div>

    <footer>
        <p>¬© 2026 All Rights Reserved | Developed by 
            <a href="https://azimahmed4.github.io/portfolio/" class="dev-link">AZIM AHMED</a>
        </p>
    </footer>

    <py-config>
        packages = ["Pillow"]
    </py-config>

    <script type="py">
        from pyscript import document
        from PIL import Image, ImageOps, ImageDraw, ImageFilter
        import io, base64, random

        async def apply_ai_style(event):
            status = document.getElementById("status")
            file_list = document.getElementById("file-upload").files
            
            if not file_list:
                status.innerHTML = "‚ùå Please select a photo!"
                return

            status.innerHTML = "üé® Mixing colors & styling..."
            
            file = await file_list.item(0).arrayBuffer()
            user_img = Image.open(io.BytesIO(file.to_bytes())).convert("RGBA")

            size = (1200, 1200)
            # ImageOps.fit automatically centers and crops perfectly
            user_img = ImageOps.fit(user_img, size)

            # Random Triple Color Mix
            colors = [
                (random.randint(100,255), random.randint(0,100), random.randint(100,255)), # Purple-ish
                (random.randint(0,100), random.randint(100,255), random.randint(150,255)), # Blue-ish
                (random.randint(200,255), random.randint(100,150), 0) # Gold/Orange
            ]
            c1, c2, c3 = random.sample(colors, 3)

            # Create Mixed Radial Background
            base = Image.new("RGBA", size, (10, 15, 30, 255))
            draw = ImageDraw.Draw(base)
            
            for i in range(200):
                alpha = int(180 * (1 - i/200))
                # Mix colors based on distance
                current_color = (
                    int(c1[0]*(1-i/200) + c2[0]*(i/200)),
                    int(c1[1]*(1-i/200) + c2[1]*(i/200)),
                    int(c1[2]*(1-i/200) + c2[2]*(i/200)),
                    alpha
                )
                draw.ellipse([i, i, 1200-i, 1200-i], outline=current_color, width=2)

            # Circular Cut
            mask = Image.new("L", size, 0)
            draw_mask = ImageDraw.Draw(mask)
            draw_mask.ellipse([60, 60, 1140, 1140], fill=255)
            
            photo_layer = Image.new("RGBA", size, (0, 0, 0, 0))
            photo_layer.paste(user_img, (0,0), mask=mask)

            # Multi-color Glowing Border
            glow_border = Image.new("RGBA", size, (0,0,0,0))
            draw_glow = ImageDraw.Draw(glow_border)
            draw_glow.ellipse([55, 55, 1145, 1145], outline=(c1[0], c1[1], c1[2], 255), width=25)
            glow_border = glow_border.filter(ImageFilter.GaussianBlur(10))
            
            final = Image.alpha_composite(base, glow_border)
            final = Image.alpha_composite(final, photo_layer)

            buffered = io.BytesIO()
            final.save(buffered, format="PNG")
            img_str = base64.b64encode(buffered.getvalue()).decode()

            out_element = document.getElementById("output")
            out_element.src = f"data:image/png;base64,{img_str}"
            out_element.style.display = "inline-block"
            
            dl_btn = document.getElementById("download-link")
            dl_btn.href = f"data:image/png;base64,{img_str}"
            dl_btn.download = "magic_profile.png"
            dl_btn.style.display = "inline-block"
            
            status.innerHTML = "‚úÖ Done! Your stylish profile is ready."

    </script>
</body>
</html>
